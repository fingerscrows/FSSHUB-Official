<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>FSS HUB | KEY GENERATOR</title>
    </head>
<body>
    <div class="card">
        <h1>ACCESS GRANTED</h1>
        <p>Generating key for your device...</p>
        <input type="text" id="key" value="WAIT..." readonly onclick="copy()">
        <button id="btn" onclick="copy()">COPY KEY</button>
        <p id="status" style="font-size: 10px; margin-top: 10px; color: #555;">Initializing...</p>
    </div>

    <script>
        // CONFIG
        const GAS_URL = "https://script.google.com/macros/s/AKfycbw9JrYXbQ-nXZsF75KJRDy1dCgPl0WYDRgk3zwuE5WlYW8P5UrIrb6WyRvxB20HI7D5iQ/exec"; 
        const TOKEN = "SAYA_SUKA_FSSHUB_GANTENG"; 

        async function init() {
            // 1. Ambil HWID dari URL (Dikirim oleh Linkvertise/Work.ink)
            const urlParams = new URLSearchParams(window.location.search);
            const userHWID = urlParams.get('hwid');

            if (!userHWID) {
                document.getElementById("key").value = "ERROR: NO HWID";
                document.getElementById("status").innerText = "Please use the link from the script!";
                return;
            }

            document.getElementById("status").innerText = "Registering Device: " + userHWID.substring(0, 8) + "...";

            try {
                // 2. Minta Server Buatkan Key untuk HWID ini
                const url = `${GAS_URL}?a=generate&t=${TOKEN}&hwid=${userHWID}`;
                const res = await fetch(url);
                const text = await res.text();
                
                if(text.includes("KEY-")) {
                    document.getElementById("key").value = text;
                    document.getElementById("status").innerText = "KEY GENERATED SUCCESSFULLY (6 HOURS)";
                } else {
                    document.getElementById("key").value = "SERVER ERROR";
                }
            } catch (e) {
                document.getElementById("key").value = "CONNECTION FAIL";
            }
        }

        function copy() {
            const k = document.getElementById("key");
            k.select(); document.execCommand("copy");
            document.getElementById("btn").innerText = "COPIED!";
        }

        init();
    </script>
</body>
</html>
